<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Arrays</title>
    <style>
        body {
            font-size: 30px
        }

        a {
            font-size: 20px
        }
    </style>
</head>

<body>

    <script>

        document.body.innerHTML = '';

        ////////////////////////////////////////////////////////////////////////////////////

        document.body.innerHTML += 'create array' + "<br><br>"

        console.log(Array.isArray({})); // false
        console.log(Array.isArray([])); // true

        var a = [];
        a[0] = 0;
        a[5] = 5;
        console.log(a); // 0,,,,,5

        var arr = [];
        arr[1000] = true;
        console.log(arr.length); // 1001

        var arr = new Array("Яблоко", "Груша", "и т.п.");
        var arr = new Array(2, 3);
        console.log(arr[0]); // 2, создан массив [2, 3], всё ок
        arr = new Array(2); // создастся ли массив [2]?
        console.log(arr[0]); // undefined! у нас массив без элементов, длины 2

        var names = 'Маша, Петя, Марина, Василий';
        var arr = names.split(', ');
        console.log("a,b,c,d".split(',', 2)); // a,b
        var str = "тест";
        console.log(str.split('')); // т,е,с,т      

        console.log(new Array(4).join("ля")); // ляляля   

        console.log("=================");

        ////////////////////////////////////////////////////////////////////////////////////

        document.body.innerHTML += 'add/delete/get elements' + "<br><br>"

        var arr = [];
        var fruits = ["Яблоко", "Апельсин", "Слива"];
        console.log(fruits[0]); // Яблоко
        fruits[2] = 'Груша'; // теперь ["Яблоко", "Апельсин", "Груша"]
        fruits[3] = 'Лимон'; // теперь ["Яблоко", "Апельсин", "Груша", "Лимон"]
        console.log(fruits.length); // 4
        console.log(fruits.pop()); // удалили "Лимон"
        console.log(fruits.pop()); // удалили "Груша"
        fruits.push("Груша");
        console.log(fruits.shift()); // удалили Яблоко
        fruits.unshift('Яблоко');
        console.log(fruits); // Яблоко, Апельсин, Груша
        fruits.push("Апельсин", "Персик");
        fruits.unshift("Ананас", "Лимон");
        // Методы push и unshift могут добавлять сразу несколько элементов:

        for (let i = 0; i < arr.length; i++) {
            console.log(arr[i]);
        }
        for (let fruit of fruits) {
            console.log(fruit);
        }
        // плохая идея
        // 1. Цикл for..in выполняет перебор всех свойств объекта, а не только цифровых.
        // 2. Цикл for..in оптимизирован под произвольные объекты, не массивы, и поэтому в 10-100 раз медленнее.
        for (let key in arr) {
            console.log(arr[key]);
        }

        // fruits[-1]  //  в JavaScript такая запись не сработает. Её результатом будет undefined, поскольку индекс в квадратных скобках понимается буквально
        fruits[fruits.length - 1];  // так сработает
        fruits.at(-1); // более короткий синтаксис

        var arr = ["Я", "иду", "домой"];
        delete arr[1]; // значение с индексом 1 удалено
        // теперь arr = ["Я", undefined, "домой"];
        console.log(arr[1]); // undefined


        var arr = ["Я", "изучаю", "JavaScript"];
        arr.splice(1, 1); // начиная с позиции 1, удалить 1 элемент
        console.log(arr); //  осталось ["Я", "JavaScript"]

        var arr = ["Я", "сейчас", "изучаю", "JavaScript"];
        // удалить 3 первых элемента и добавить другие вместо них
        arr.splice(0, 3, "Мы", "изучаем")
        console.log(arr) // теперь ["Мы", "изучаем", "JavaScript"]

        var arr = ["Я", "сейчас", "изучаю", "JavaScript"];
        // удалить 2 первых элемента
        var removed = arr.splice(0, 2);
        console.log(removed); // "Я", "сейчас" <-- array of removed elements

        var arr = ["Я", "изучаю", "JavaScript"];
        // с позиции 2
        // удалить 0
        // вставить "сложный", "язык"
        arr.splice(2, 0, "сложный", "язык");
        console.log(arr); // "Я", "изучаю", "сложный", "язык", "JavaScript"

        var arr = [1, 2, 5]
        // начиная с позиции индексом -1 (перед последним элементом)
        // удалить 0 элементов,
        // затем вставить числа 3 и 4
        arr.splice(-1, 0, 3, 4);
        console.log(arr); // результат: 1,2,3,4,5

        // arr.slice([start], [end])
        // возвращает новый массив, в который копирует все элементы с индекса start до end (не включая end). start и end могут быть отрицательными
        var arr = ["Почему", "надо", "учить", "JavaScript"];
        var arr2 = arr.slice(1, 3); // элементы 1, 2 (не включая 3)
        console.log(arr2); // надо, учить        

        console.log("=================");

        ////////////////////////////////////////////////////////////////////////////////////

        document.body.innerHTML += 'arrays\' methods' + "<br><br>"


        var arr = ['Маша', 'Петя', 'Марина', 'Василий'];
        var str = arr.join(';');
        console.log(str); // Маша;Петя;Марина;Василий

        var arr2 = arr.slice(-2); // копировать от 2-го элемента с конца и дальше

        var arr = [1, 2, 15];
        arr.sort(); // возвращает отсортированный массив, но обычно возвращаемое значение игнорируется, так как изменяется сам arr
        console.log(arr); // 1, 15, 2 - элементы преобразуются в строки при сравнении

        function compareNumeric(a, b) {
            if (a > b) return 1;
            if (a == b) return 0;
            if (a < b) return -1;
        }
        arr.sort(compareNumeric);
        console.log(arr); // 1, 2, 15

        arr.sort(function(a, b) { return a - b; });
        console.log(arr); // 1, 2, 15

        arr.sort( (a, b) => a - b );

        // если мы когда-нибудь захотим узнать, какие элементы сравниваются – ничто не мешает нам вывести их на экран:
        [1, -2, 15, 2, 0, 8].sort(function (a, b) {
            console.log(a + " <> " + b);
            return a - b;
        });

        arr.reverse();

        var newArr = arr.concat(3, 4);

        // Если аргумент argN – массив, то копируются все его элементы. Иначе копируется сам аргумент
        var arr = [1, 2];
        var newArr = arr.concat([3, 4], 5); // то же самое, что arr.concat(3,4,5)

        // если массивоподобный объект имеет специальное свойство Symbol.isConcatSpreadable, то он обрабатывается как массив

        var arr = [1, 2];
        let arrayLike = {
            0: "что-то",
            1: "ещё",
            [Symbol.isConcatSpreadable]: true,
            length: 2
        };
        console.log(arr.concat(arrayLike)); // 1,2,что-то,ещё


        var arr = [1, 0, false];
        console.log(arr.indexOf(0)); // 1
        console.log(arr.lastIndexOf(0)); // 1
        console.log(arr.indexOf(false)); // 2
        console.log(arr.indexOf(null)); // -1
        console.log(arr.includes(1)); // true  // includes – он правильно обрабатывает NaN, в отличие от indexOf

        var user = {
            name: "Петя",
            age: 30
        }
        var keys = Object.keys(user); // array
        console.log(keys); // name, age

        // arr.forEach позволяет запускать функцию для каждого элемента массива
        var arr = ["Яблоко", "Апельсин", "Груша"];
        arr.forEach(function (item, i, arr) {
            console.log(i + ": " + item + " (массив:" + arr + ")");
        });

        var arr = [1, -1, 2, -2, 3];
        console.log(String(arr) === '1,-1,2,-2,3'); // true

        // let result = arr.find(function(item, index, array) {
        let users = [
            { id: 1, name: "Вася" },
            { id: 2, name: "Петя" },
            { id: 3, name: "Маша" },
            { id: 4, name: "Вася" }
        ];
        let user1 = users.find(item => item.id == 1); // мы передаём find функцию item => item.id == 1 с одним аргументом, другие аргументы используются редко
        console.log(user1.name); // Вася

        // Найти индекс первого Васи
        console.log(users.findIndex(user => user.name == 'Вася')); // 0

        // Найти индекс последнего Васи
        console.log(users.findLastIndex(user => user.name == 'Вася')); // 3

        var arr = [1, -1, 2, -2, 3];
        var positiveArr = arr.filter(function (number) {
            return number > 0;
        });
        console.log(positiveArr); // 1,2,3



        console.log("=================");

        var names = ['HTML', 'CSS', 'JavaScript'];
        var nameLengths = names.map(function (name) {
            return name.length;
        });
        // получили массив с длинами
        console.log(nameLengths); // 4,3,10

        var arr = [1, -1, 2, -2, 3];
        function isPositive(number) {
            return number > 0;
        }
        console.log(arr.every(isPositive)); // false, не все положительные
        console.log(arr.some(isPositive)); // true, есть хоть одно положительное

        // arr.reduce(function(accumulator, item, index, array)
        var arr = [1, 2, 3, 4, 5]
        // для каждого элемента массива запустить функцию,
        // промежуточный результат передавать первым аргументом далее
        var result = arr.reduce(function (sum, current) {   // callback(previousValue, currentItem, index, arr):
            return sum + current;
        }, 0);
        console.log(result); // 15

        result = arr.reduce((sum, current) => sum + current, 0); // Функция, переданная в reduce, использует только два аргумента, этого обычно достаточно

        // Метод arr.reduceRight работает аналогично, но проходит по массиву справа налево.

        function sayHi() {
            for (var i = 0; i < arguments.length; i++) {
                console.log("Привет, " + arguments[i]);
            }
        }
        sayHi("Винни", "Пятачок"); // 'Привет, Винни', 'Привет, Пятачок'


        function f(x) {
            "use strict"; // для браузеров с поддержкой строгого режима
            arguments[0] = 5;
            console.log(x); // не 5, а 1! Переменная "отвязана" от arguments
        }
        f(1);

        console.log("=================");

        ////////////////////////////////////////////////////////////////////////////////////

        // TODO: iterators - Перебираемые объекты

    </script>

    <br>
    <a href="../index.html">home</a>

</body>

</html>